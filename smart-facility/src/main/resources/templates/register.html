<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Register | Smart Facility</title>
    <link rel="stylesheet" th:href="@{/css/styles.css}">
    <script defer th:src="@{/js/app.js}"></script>
    <script defer>
        document.addEventListener("DOMContentLoaded", () => {
            setActiveNav("/auth/register");
            const form = document.getElementById("register-form");
            form.addEventListener("submit", async (e) => {
                e.preventDefault();
                clearAlert("reg-alert");
                const data = {
                    email: form.email.value,
                    password: form.password.value,
                    fullName: form.fullName.value
                };
                try {
                    await apiFetch("/auth/register", { method: "POST", body: JSON.stringify(data) });
                    showAlert("reg-alert", "Account created. You can now sign in.", "success");
                } catch (err) {
                    showAlert("reg-alert", err.message);
                }
            });
        });
    </script>
</head>
<body>
<header class="header">
    <div class="brand">Smart Facility</div>
    <nav class="nav">
        <a href="/auth/login">Login</a>
        <a href="/auth/register" class="active">Register</a>
    </nav>
</header>
<div class="page" style="max-width:520px;">
    <div class="card">
        <h2 style="margin-top:0;">Create account</h2>
        <form id="register-form" class="grid">
            <div>
                <label class="label" for="fullName">Full name</label>
                <input id="fullName" name="fullName" required>
            </div>
            <div>
                <label class="label" for="email">Email</label>
                <input id="email" name="email" type="email" required autocomplete="email">
            </div>
            <div>
                <label class="label" for="password">Password (min 8)</label>
                <input id="password" name="password" type="password" required minlength="8" autocomplete="new-password">
            </div>
            <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}">
            <button class="btn btn-primary" type="submit">Register</button>
        </form>
        <div id="reg-alert"></div>
        <p style="margin-top:12px;">Already have an account? <a href="/auth/login">Sign in</a></p>
    </div>
</div>
</body>
</html>
